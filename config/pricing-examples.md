# 价格逻辑示例

## 按钮状态逻辑

### 单次购买模式

| 用户状态 | 按钮显示 | 是否可点击 | 说明 |
|---------|---------|-----------|------|
| 未登录 | "登录后购买" | ✅ | 点击后跳转登录 |
| 已登录，未购买 | "立即购买" | ✅ | 正常购买流程 |
| 已购买相同产品 | "已购买" | ❌ | 防止重复购买 |
| 已购买其他产品 | "立即购买" | ✅ | 可以购买不同产品 |
| 有活跃订阅 | "立即购买" | ✅ | 单次购买不受订阅影响 |

### 订阅模式

| 用户状态 | 按钮显示 | 是否可点击 | 说明 |
|---------|---------|-----------|------|
| 未登录 | "登录后购买" | ✅ | 点击后跳转登录 |
| 已登录，无订阅 | "开始订阅" | ✅ | 正常订阅流程 |
| 已订阅相同计划 | "已订阅" | ❌ | 防止重复订阅 |
| 已订阅其他计划 | "切换订阅" | ✅ | 允许切换订阅计划 |
| 只有单次购买 | "开始订阅" | ✅ | 单次购买不影响订阅 |

## 业务逻辑说明

### 1. 单次购买 vs 订阅
- **独立性**：单次购买和订阅是独立的，互不影响
- **用户可以**：先买单次产品，后来订阅服务
- **用户可以**：有订阅的同时购买单次产品

### 2. 订阅管理
- **单一订阅**：用户同时只能有一个活跃订阅
- **订阅切换**：可以从一个订阅计划切换到另一个
- **升级/降级**：通过"切换订阅"实现

### 3. 防重复购买
- **单次购买**：相同产品不能重复购买
- **订阅**：相同计划不能重复订阅

## 实际场景示例

### 场景1：新用户
1. 看到所有按钮都是"立即购买"/"开始订阅"
2. 可以选择任意计划

### 场景2：已有单次购买的用户
1. 单次购买模式：已购买的显示"已购买"，其他正常
2. 订阅模式：所有都显示"开始订阅"

### 场景3：已有订阅的用户
1. 单次购买模式：所有都显示"立即购买"
2. 订阅模式：当前订阅显示"已订阅"，其他显示"切换订阅"

### 场景4：既有单次购买又有订阅的用户
1. 单次购买模式：已购买的显示"已购买"，其他正常
2. 订阅模式：当前订阅显示"已订阅"，其他显示"切换订阅" 